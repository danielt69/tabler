{"version":3,"sources":["main.js"],"names":["handleDrop","e","i","f","files","length","reader","FileReader","name","onload","data","target","result","workbook","XLSX","read","type","window","$","val","tableBuilder","htmlBuilder","jsonBuilder","readAsBinaryString","sheet_name_list","SheetNames","forEach","y","worksheet","Sheets","json","utils","sheet_to_json","_wrapper_start","_wrapper_end","_tableHeading_row_open","_tableHeading_row_close","_tableHeading_th_open","_tableHeading_th_close","_tableBody_row_open","_tableBody_row_close","_tableBody_td_open","_tableBody_td_close","htmlTable","tableHeading","each","index","value","tableBody","append","_rowTemplate","JSON","stringify","isLocalhost","Boolean","location","hostname","match","navigator","protocol","serviceWorker","register","then","registration","onupdatefound","controller","installingWorker","installing","onstatechange","state","Error","console","error","simpleTabs","aaa","bbb","this","on","addClass","siblings","removeClass","eq","document","ready","event","preventDefault","stopPropagation","originalEvent","dataTransfer","html"],"mappings":"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","file":"main.min.js","sourcesContent":["/*!\n *\n *  Web Starter Kit\n *  Copyright 2015 Google Inc. All rights reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    https://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License\n *\n */\n/* eslint-env browser */\n(function() {\n  'use strict';\n\n  // Check to make sure service workers are supported in the current browser,\n  // and that the current page is accessed from a secure origin. Using a\n  // service worker from an insecure origin will trigger JS console errors. See\n  // http://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features\n  var isLocalhost = Boolean(window.location.hostname === 'localhost' ||\n      // [::1] is the IPv6 localhost address.\n      window.location.hostname === '[::1]' ||\n      // 127.0.0.1/8 is considered localhost for IPv4.\n      window.location.hostname.match(\n        /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n      )\n    );\n\n  if ('serviceWorker' in navigator &&\n      (window.location.protocol === 'https:' || isLocalhost)) {\n    navigator.serviceWorker.register('service-worker.js')\n    .then(function(registration) {\n      // updatefound is fired if service-worker.js changes.\n      registration.onupdatefound = function() {\n        // updatefound is also fired the very first time the SW is installed,\n        // and there's no need to prompt for a reload at that point.\n        // So check here to see if the page is already controlled,\n        // i.e. whether there's an existing service worker.\n        if (navigator.serviceWorker.controller) {\n          // The updatefound event implies that registration.installing is set:\n          // https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-container-updatefound-event\n          var installingWorker = registration.installing;\n\n          installingWorker.onstatechange = function() {\n            switch (installingWorker.state) {\n              case 'installed':\n                // At this point, the old content will have been purged and the\n                // fresh content will have been added to the cache.\n                // It's the perfect time to display a \"New content is\n                // available; please refresh.\" message in the page's interface.\n                break;\n\n              case 'redundant':\n                throw new Error('The installing ' +\n                                'service worker became redundant.');\n\n              default:\n                // Ignore\n            }\n          };\n        }\n      };\n    }).catch(function(e) {\n      console.error('Error during service worker registration:', e);\n    });\n  }\n\n  // Your custom JavaScript goes here\n\n  //helpers\n  function handleDrop(e) {\n    // e.stopPropagation();\n    // e.preventDefault();\n    var files = e;\n    var i,f;\n    for (i = 0, f = files[i]; i != files.length; ++i) {\n      var reader = new FileReader();\n      var name = f.name;\n      reader.onload = function(e) {\n        var data = e.target.result;\n\n        /* if binary string, read with type 'binary' */\n        var workbook = XLSX.read(data, {type: 'binary'});\n\n        // var sheet_name_list = workbook.SheetNames;\n        // sheet_name_list.forEach(function(y) { /* iterate through sheets */\n        //   var worksheet = workbook.Sheets[y];\n        //   var json = XLSX.utils.sheet_to_json(worksheet);\n        // });\n        window.workbook = workbook;\n\t\tif ($('.radio.active input').val() == 'table') {\n\t\t\ttableBuilder(workbook);\n\t\t} else if ($('.radio.active input').val() == 'html') {\n\t\t\thtmlBuilder(workbook);\n\t\t} else if ($('.radio.active input').val() == 'json') {\n\t\t\tjsonBuilder(workbook);\n\t\t}\n      };\n      reader.readAsBinaryString(f);\n    }\n  } \n\n  var simpleTabs = function(aaa,bbb) { // aaa = tabs, bbb = section that links to tab\n    aaa.each(function(index, value) {\n        $(this).on('click.tab', function(e) {\n            $(this).addClass('active').siblings().removeClass('active');\n            bbb[index] && bbb.removeClass('active').eq(index).addClass('active');            \n        });\n    });\n  }\n\n  function tableBuilder(workbook) {\n\n    var sheet_name_list = workbook.SheetNames;\n    sheet_name_list.forEach(function(y) { /* iterate through sheets */\n\t\tvar worksheet = workbook.Sheets[y];\n\t\tvar json = XLSX.utils.sheet_to_json(worksheet);\n\n\t    var _wrapper_start = $('form.option.table .wrapper_start').val()           || '<table class=\"table table-hover table-responsive\"><tbody>';\n\t    var _wrapper_end = $('form.option.table .wrapper_end').val()             || '</table></tbody>';\n\t    var _tableHeading_row_open = $('form.option.table .tableHeading_row_open').val()   || '<tr>';\n\t    var _tableHeading_row_close = $('form.option.table .tableHeading_row_close').val()  || '</tr>';\n\t    var _tableHeading_th_open = $('form.option.table .tableHeading_th_open').val()    || '<th>';\n\t    var _tableHeading_th_close = $('form.option.table .tableHeading_th_close').val()   || '</th>';\n\t    var _tableBody_row_open = $('form.option.table .tableBody_row_open').val()      || '<tr>';\n\t    var _tableBody_row_close = $('form.option.table .tableBody_row_close').val()     || '</tr>';\n\t    var _tableBody_td_open = $('form.option.table .tableBody_td_open').val()       || '<td>';\n\t    var _tableBody_td_close = $('form.option.table .tableBody_td_close').val()      || '</td>';\n\n\t    var htmlTable = '';\n\n\t    var tableHeading = _tableHeading_row_open;\n\t    $.each(json[0], function( index, value ) {\n\t      tableHeading += _tableHeading_th_open + index + _tableHeading_th_close;\n\t    });\n\t    tableHeading += _tableHeading_row_close;\n\n\t    var tableBody = '';\n\t    for (var i = 0; i < json.length; i++) {\n\t      tableBody += _tableBody_row_open;\n\t      $.each(json[i], function( index, value ) {\n\t        tableBody += _tableBody_td_open + value + _tableBody_td_close;\n\t      });\n\t      tableBody += _tableBody_row_close;\n\t    }\n\n\t    htmlTable = _wrapper_start + tableHeading + tableBody + _wrapper_end;\n\t    $('.output').append(htmlTable);\n    });\n  }\n\n  function htmlBuilder\n(json) {\n  \tvar sheet_name_list = workbook.SheetNames;\n    sheet_name_list.forEach(function(y) { /* iterate through sheets */\n\t\tvar worksheet = workbook.Sheets[y];\n\t\tvar json = XLSX.utils.sheet_to_json(worksheet);\n\t    var _wrapper_start = $('form.option.html .wrapper_start').val()           || '<section class=\"compare_table\">';\n\t    var _wrapper_end = $('form.option.html .wrapper_end').val()             || '</section>';\n\t    var _rowTemplate = '';\n\t    var htmlTable = '';\n\n\t    htmlTable = _wrapper_start + _rowTemplate + _wrapper_end;\n\t    $('.output').append(htmlTable);\n    });\n  }\n\n  function jsonBuilder(json) {\n  \tvar sheet_name_list = workbook.SheetNames;\n    sheet_name_list.forEach(function(y) { /* iterate through sheets */\n\t\tvar worksheet = workbook.Sheets[y];\n\t\tvar json = XLSX.utils.sheet_to_json(worksheet);\n    \t$('.output').append(JSON.stringify(window.workbook));\n\t});\n  }\n\n  //code\n$( document ).ready(function() {\n\n\n  $(\"html\").on(\"dragover\", function(event) {\n      event.preventDefault();  \n      event.stopPropagation();\n      $(this).addClass('dragging');\n  }).on(\"dragleave\", function(event) {\n      event.preventDefault();  \n      event.stopPropagation();\n      $(this).removeClass('dragging');\n  }).on(\"drop\", function(event) {\n    if(event.originalEvent.dataTransfer){\n        if(event.originalEvent.dataTransfer.files.length) {\n            event.preventDefault();\n            event.stopPropagation();\n            /*UPLOAD FILES HERE*/\n            $('.output').html('')\n            handleDrop(event.originalEvent.dataTransfer.files);\n        }   \n    }\n    $(this).removeClass('dragging');\n  });\n\n\n  simpleTabs($('.radio'),$('form.option'));\n  $('.radio input').on('click.build', function(e) {\n    if (window.workbook) {\n      $('.output').html('');\n      if ($(this).val() == 'table') {\n        tableBuilder(window.workbook);\n      } else if ($(this).val() == 'html') {\n        htmlBuilder(window.workbook);\n      } else if ($(this).val() == 'json') {\n        jsonBuilder(window.workbook);\n      }     \n    }\n  });\n\n});\n\n  \n})();\n"]}