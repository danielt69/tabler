{"version":3,"sources":["main.js"],"names":["handleDrop","e","i","f","files","length","reader","FileReader","name","onload","data","target","result","workbook","XLSX","read","type","window","$","val","tableBuilder","htmlBuilder","jsonBuilder","readAsBinaryString","setTimeout","children","before","each","Clipboard","this","text","next","outerHTML","sheet_name_list","SheetNames","forEach","y","worksheet","Sheets","json","utils","sheet_to_json","_wrapper_start","_wrapper_end","_tableHeading_row_open","_tableHeading_row_close","_tableHeading_th_open","_tableHeading_th_close","_tableBody_row_open","_tableBody_row_close","_tableBody_td_open","_tableBody_td_close","htmlTable","tableHeading","index","value","tableBody","append","_rowTemplate","JSON","stringify","isLocalhost","Boolean","location","hostname","match","navigator","protocol","serviceWorker","register","then","registration","onupdatefound","controller","installingWorker","installing","onstatechange","state","Error","console","error","simpleTabs","aaa","bbb","on","addClass","siblings","removeClass","eq","document","ready","event","preventDefault","stopPropagation","originalEvent","dataTransfer","html"],"mappings":"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","file":"main.js","sourcesContent":["/*!\n *\n *  Web Starter Kit\n *  Copyright 2015 Google Inc. All rights reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    https://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License\n *\n */\n/* eslint-env browser */\n(function() {\n  'use strict';\n\n  // Check to make sure service workers are supported in the current browser,\n  // and that the current page is accessed from a secure origin. Using a\n  // service worker from an insecure origin will trigger JS console errors. See\n  // http://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features\n  var isLocalhost = Boolean(window.location.hostname === 'localhost' ||\n      // [::1] is the IPv6 localhost address.\n      window.location.hostname === '[::1]' ||\n      // 127.0.0.1/8 is considered localhost for IPv4.\n      window.location.hostname.match(\n        /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n      )\n    );\n\n  if ('serviceWorker' in navigator &&\n      (window.location.protocol === 'https:' || isLocalhost)) {\n    navigator.serviceWorker.register('service-worker.js')\n    .then(function(registration) {\n      // updatefound is fired if service-worker.js changes.\n      registration.onupdatefound = function() {\n        // updatefound is also fired the very first time the SW is installed,\n        // and there's no need to prompt for a reload at that point.\n        // So check here to see if the page is already controlled,\n        // i.e. whether there's an existing service worker.\n        if (navigator.serviceWorker.controller) {\n          // The updatefound event implies that registration.installing is set:\n          // https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-container-updatefound-event\n          var installingWorker = registration.installing;\n\n          installingWorker.onstatechange = function() {\n            switch (installingWorker.state) {\n              case 'installed':\n                // At this point, the old content will have been purged and the\n                // fresh content will have been added to the cache.\n                // It's the perfect time to display a \"New content is\n                // available; please refresh.\" message in the page's interface.\n                break;\n\n              case 'redundant':\n                throw new Error('The installing ' +\n                                'service worker became redundant.');\n\n              default:\n                // Ignore\n            }\n          };\n        }\n      };\n    }).catch(function(e) {\n      console.error('Error during service worker registration:', e);\n    });\n  }\n\n  // Your custom JavaScript goes here\n\n  //helpers\n  function handleDrop(e) {\n    // e.stopPropagation();\n    // e.preventDefault();\n    var files = e;\n    var i,f;\n    for (i = 0, f = files[i]; i != files.length; ++i) {\n      var reader = new FileReader();\n      var name = f.name;\n      reader.onload = function(e) {\n        var data = e.target.result;\n\n        /* if binary string, read with type 'binary' */\n        var workbook = XLSX.read(data, {type: 'binary'});\n\n        // var sheet_name_list = workbook.SheetNames;\n        // sheet_name_list.forEach(function(y) { /* iterate through sheets */\n        //   var worksheet = workbook.Sheets[y];\n        //   var json = XLSX.utils.sheet_to_json(worksheet);\n        // });\n        window.workbook = workbook;\n    \t\tif ($('.radio.active input').val() == 'table') {\n    \t\t\ttableBuilder(workbook);\n    \t\t} else if ($('.radio.active input').val() == 'html') {\n    \t\t\thtmlBuilder(workbook);\n    \t\t} else if ($('.radio.active input').val() == 'json') {\n    \t\t\tjsonBuilder(workbook);\n    \t\t}\n      };\n      reader.readAsBinaryString(f);\n    }\n\n    setTimeout(function(){\n        $('.output').children().before('<button title=\"copy\" class=\"copy btn btn-default\"><i class=\"fa fa-clipboard\" aria-hidden=\"true\"></i> Copy</button>');\n        $('.btn').each(function(){\n          var clipboard = new Clipboard(this, {\n                text: function(e) {\n                    return $(e).next()[0].outerHTML\n                }\n            });\n        })\n    }, 1000);\n  } \n\n  var simpleTabs = function(aaa,bbb) { // aaa = tabs, bbb = section that links to tab\n    aaa.each(function(index, value) {\n        $(this).on('click.tab', function(e) {\n            $(this).addClass('active').siblings().removeClass('active');\n            bbb[index] && bbb.removeClass('active').eq(index).addClass('active');            \n        });\n    });\n  }\n\n  function tableBuilder(workbook) {\n\n    var sheet_name_list = workbook.SheetNames;\n    sheet_name_list.forEach(function(y) { /* iterate through sheets */\n\t\tvar worksheet = workbook.Sheets[y];\n\t\tvar json = XLSX.utils.sheet_to_json(worksheet);\n\n\t    var _wrapper_start = $('form.option.table .wrapper_start').val()           || '<table class=\"table table-hover table-responsive\"><tbody>';\n\t    var _wrapper_end = $('form.option.table .wrapper_end').val()             || '</table></tbody>';\n\t    var _tableHeading_row_open = $('form.option.table .tableHeading_row_open').val()   || '<tr>';\n\t    var _tableHeading_row_close = $('form.option.table .tableHeading_row_close').val()  || '</tr>';\n\t    var _tableHeading_th_open = $('form.option.table .tableHeading_th_open').val()    || '<th>';\n\t    var _tableHeading_th_close = $('form.option.table .tableHeading_th_close').val()   || '</th>';\n\t    var _tableBody_row_open = $('form.option.table .tableBody_row_open').val()      || '<tr>';\n\t    var _tableBody_row_close = $('form.option.table .tableBody_row_close').val()     || '</tr>';\n\t    var _tableBody_td_open = $('form.option.table .tableBody_td_open').val()       || '<td>';\n\t    var _tableBody_td_close = $('form.option.table .tableBody_td_close').val()      || '</td>';\n\n\t    var htmlTable = '';\n\n\t    var tableHeading = _tableHeading_row_open;\n\t    $.each(json[0], function( index, value ) {\n\t      tableHeading += _tableHeading_th_open + index + _tableHeading_th_close;\n\t    });\n\t    tableHeading += _tableHeading_row_close;\n\n\t    var tableBody = '';\n\t    for (var i = 0; i < json.length; i++) {\n\t      tableBody += _tableBody_row_open;\n\t      $.each(json[i], function( index, value ) {\n\t        tableBody += _tableBody_td_open + value + _tableBody_td_close;\n\t      });\n\t      tableBody += _tableBody_row_close;\n\t    }\n\n\t    htmlTable = _wrapper_start + tableHeading + tableBody + _wrapper_end;\n\t    $('.output').append(htmlTable);\n    });\n  }\n\n  function htmlBuilder (json) {\n  \tvar sheet_name_list = workbook.SheetNames;\n    sheet_name_list.forEach(function(y) { /* iterate through sheets */\n\t\tvar worksheet = workbook.Sheets[y];\n\t\tvar json = XLSX.utils.sheet_to_json(worksheet);\n\t    var _wrapper_start = $('form.option.html .wrapper_start').val()           || '<section class=\"compare_table\">';\n\t    var _wrapper_end = $('form.option.html .wrapper_end').val()             || '</section>';\n\t    var _rowTemplate = '';\n\t    var htmlTable = '';\n\n\t    htmlTable = _wrapper_start + _rowTemplate + _wrapper_end;\n\t    $('.output').append(htmlTable);\n    });\n  }\n\n  function jsonBuilder(json) {\n    \tvar sheet_name_list = workbook.SheetNames;\n      sheet_name_list.forEach(function(y) { /* iterate through sheets */\n  \t\tvar worksheet = workbook.Sheets[y];\n  \t\tvar json = XLSX.utils.sheet_to_json(worksheet);\n      \t$('.output').append(JSON.stringify(window.workbook));\n  \t});\n  }\n\n  //code\n$( document ).ready(function() {\n\n\n  $(\"html\").on(\"dragover\", function(event) {\n      event.preventDefault();  \n      event.stopPropagation();\n      $(this).addClass('dragging');\n  }).on(\"dragleave\", function(event) {\n      event.preventDefault();  \n      event.stopPropagation();\n      $(this).removeClass('dragging');\n  }).on(\"drop\", function(event) {\n    if(event.originalEvent.dataTransfer){\n        if(event.originalEvent.dataTransfer.files.length) {\n            event.preventDefault();\n            event.stopPropagation();\n            /*UPLOAD FILES HERE*/\n            $('.output').html('')\n            handleDrop(event.originalEvent.dataTransfer.files);\n        }   \n    }\n    $(this).removeClass('dragging');\n  });\n\n\n  simpleTabs($('.radio'),$('form.option'));\n  $('.radio input').on('click.build', function(e) {\n    if (window.workbook) {\n      $('.output').html('');\n      if ($(this).val() == 'table') {\n        tableBuilder(window.workbook);\n      } else if ($(this).val() == 'html') {\n        htmlBuilder(window.workbook);\n      } else if ($(this).val() == 'json') {\n        jsonBuilder(window.workbook);\n      }     \n    }\n  });\n\n});\n\n  \n})();\n"]}